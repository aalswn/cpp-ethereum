version: 1
machine:
  xcode:
    version: 9.0

dependencies:
  override:
    - echo $PATH
    - echo $HOMEBREW_PREFIX
    - make --version
    - python --version
    - python3 --version
    - HOMEBREW_PREFIX=$HOME brew install cmake ninja leveldb libmicrohttpd
    - export PATH="$HOME/bin:$PATH"

test:
  override:
    - echo $PATH
    - git submodule update --init --depth 1
    - pwd
    - ls -l
    - mkdir -p build && cd build
    - clang --version
    - cmake --version
    - make --version
    - ninja --version
    - cd build && cmake .. -G Ninja
    - cd build && ninja

